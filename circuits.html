<!DOCTYPE html>
<html lang="en">
	<head>
		<title>TFL - Circuits</title>
		<meta charset="utf-8">

		<!-- CSS for bootstrap -->
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

		<!-- jQuery -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

		<!-- Bootstrap JavaScript -->
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

		<!-- D3 library -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>

		<style>

			body {
				background:
					radial-gradient(black 15%, transparent 16%) 0 0,
					radial-gradient(black 15%, transparent 16%) 8px 8px,
					radial-gradient(rgba(255,255,255,.1) 15%, transparent 20%) 0 1px,
					radial-gradient(rgba(255,255,255,.1) 15%, transparent 20%) 8px 9px;
					background-color:#282828;
					background-size:16px 16px;
			}

			#toolbox {
				position: relative;
				border: 3px solid black;
				left: 2%;
				height: 550px;
				background-color: white;
			}

			#buildArea {
				position: relative;
				left: 4%;
				border: 3px solid black;
				width: 69%;
				height: 550px;
				background-color: white;
			}

			#workbenchContainer {
				position: relative;
			}

			#titleBanner {
				color: white;
			}

			.andGate {
				cursor: move;
				fill: red;
				stroke: #000;
				stroke-width: 1.5px;
			}

			.orGate {
				cursor: move;
				fill: orange;
				stroke: #000;
				stroke-width: 1.5px;
			}

			.notGate {
				cursor: move;
				fill: green;
				stroke: #000;
				stroke-width: 1.5px;
			}




		</style>

	</head>

	<body>
		<div class="container-fluid text-center">
			<h1 id="titleBanner">Circuits, Truth Tables, and Logic Functions</h1>
		</div>
		<div class="container-fluid" id="workbenchContainer">
			<div class="row">
				<div class="col-md-3" id="toolbox">
					<h3>Toolbox</h3>
					Choose logic gates to add to your circuit from this selection.
					<br>
					<br>
					<br>
					<button type="button" class="btn btn-large btn-primary btn-block" id="addAND">AND GATE<br><span class="glyphicon glyphicon-plus"></span></button>
					
					<br>
					
					<button type="button" class="btn btn-large btn-primary btn-block" id="addOR">OR GATE<br><span class="glyphicon  glyphicon-resize-full"></span></button>
					
					<br>
					
					<button type="button" class="btn btn-large btn-primary btn-block" id="addNOT">NOT GATE<br><span class="glyphicon glyphicon-minus"></span></button>
					
					<br>

					<button type="button" class="btn btn-large btn-danger btn-block" id="clearCanvas" data-toggle="modal" data-target="#clearConfirmationMsg">CLEAR WORKBENCH<br><span class="glyphicon glyphicon-remove"></span></button>
				</div>

				<div class="col-md-9" id="buildArea">

				</div>
			</div>
		</div>

		<div id="clearConfirmationMsg" class="modal fade" role="dialog">
			<div class="modal-dialog">
		    	<div class="modal-content">
		      		<div class="modal-header">
		        		<button type="button" class="close" data-dismiss="modal">&times;</button>
		        			<h4 class="modal-title">Clear entire workbench?</h4>
		      		</div>
		      		<div class="modal-body">
		        		<p>Are you sure you want to totally clear the workbench and start over?</p>
		      		</div>
		      		<div class="modal-footer">
		       	 		<button type="button" id="executeClear" class="btn btn-success btn-block" data-dismiss="modal">Yes</button>
		       	 		<button type="button" class="btn btn-danger btn-block" data-dismiss="modal">No</button>
		      		</div>
		    	</div>

		  	</div>
		</div>
		

		<script type="text/javascript">
			

			var svgWorkbenchArea = d3.select("#buildArea")
				.append("svg")
	            .attr('width', $("#buildArea").width())
	            .attr('height',  $("#buildArea").height());

	    

	    	var drag = d3.behavior.drag()
	    		.on("drag", gateMoved)
	    		.on("dragstart", dragBegun)
	    		.on("dragend", dragEnded);
          

	    	function gateMoved(d) {
	    		var x = d3.event.x;
	    		var y = d3.event.y;

	    		d3.select(this).attr("transform", "translate(" + x + "," + y + ")");
	    	}

	    	function dragBegun() {
	    		d3.select(this).transition()
			      .ease("elastic")
			      .duration(500)
			      .attr("r", 48);
	    	}

	    	function dragEnded() {
	    		d3.select(this).transition()
			      .ease("elastic")
			      .duration(500)
			      .attr("r", 30);
	    	}

            // Invoke to add a single gate of type 'gateType' to the workbench area
            function addGate(event) {
            	svgWorkbenchArea.append("circle")
            		.attr("r", 30)
            		.attr("class", event.data.gateType)
            		.attr("transform", "translate(" + $("#buildArea").width() / 2 + "," +  $("#buildArea").height() / 2 + ")")
            		.call(drag)
            }

            function clearWorkbench() {
            	svgWorkbenchArea.selectAll(".gate").remove();
            }

            $("#addAND").click({ gateType: 'andGate gate' }, addGate)
            $("#addOR").click({ gateType: 'orGate gate' }, addGate)
            $("#addNOT").click({ gateType: 'notGate gate' }, addGate)

            $("#executeClear").click(clearWorkbench)

         


		</script>

	</body>
</html>